var EZFC;EZFC_Object=function(P){var H=this,f="__HIDDEN__",R=["in","not_in","selected","not_selected","selected_index","not_selected_index","selected_id","not_selected_id","selected_count","not_selected_count"];this.init=function(){"undefined"==typeof EZFC_LOADED&&(EZFC_LOADED=!0,this.form_vars=[],this.$form_elements=[],this.$element_trigger=0,this.trigger_list=[],this.subtotals=[],this.conditional_once=[],this.payment_form_id=0,this.payment_methods=["stripe","authorize"],this.elements_cache=[],this.group_repeat_elements=[],this.uploaded_files=[],this.skip_init_blur_classes=["ezfc-slider","ezfc-spinner"],this.current_steps=[],this.step_is_changing=!1,this.functions={calculate_element:function(e,t){return H.calculate_element(e,t)},calculate_price:function(e){var t=P(".ezfc-form[data-id='"+e+"']");return H.calculate_price(t)},get_calculated_value_from:function(e,t){return H.get_calculated_element_value(e,t)},get_element_id_by_name:function(e,t){!t&&e&&(t=e);var a=P(".ezfc-form [data-elementname='"+t+"']");if(!a)return!1;if(!(e=e||a.closest(".ezfc-form").data("id")))return!1;for(var i in ezfc_vars.element_vars[e]){var r=ezfc_vars.element_vars[e][i];if(H.get_element_object_value(r,"name","").toLowerCase()==(t=t.toLowerCase()))return r.id}return!1},get_selected_id:function(e){var t;if("number"==typeof e)t=e;else{if("string"!=typeof e)return H.debug_message("Unknown object type: "+e),!1;if(!(t=H.functions.get_element_id_by_name(null,e)))return H.debug_message("Unknown element: "+e),!1}var a=H.functions.get_value_from(t,!0,!0,{return_value:"option_id"});return 1==a.length?a[0]:H.functions.get_value_from(t,!0,!0,{return_value:"option_id"})},get_value_from:function(e,t,a,i){return H.get_value_from_element(null,e,t,a,i)},get_value_from_name:function(e,t,a){var i=H.functions.get_element_id_by_name(e,t);return H.functions.get_value_from(i,a)},price_format:function(e,t,a,i,r){return H.format_price(e,t,a,i,r)}},ezfc_functions=this.functions,this.external_listeners=[],this.price_old_global=[],numeral.register("locale","ezfc",{delimiters:{decimal:ezfc_vars.price_format_dec_point,thousands:ezfc_vars.price_format_dec_thousand},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(e){var t=e%10;return 1==~~(e%100/10)?"th":1==t?"st":2==t?"nd":3==t?"rd":"th"},currency:{symbol:"$"}}),numeral.locale("ezfc"),this.defaultFormat=ezfc_vars.price_format?ezfc_vars.price_format:"0,0[.][000000]",numeral.defaultFormat(this.defaultFormat),P.datepicker.setDefaults(P.datepicker.regional[ezfc_vars.datepicker_language]),this.attach_events(),this.init_tips())},this.attach_events=function(){P(document).on("click",".ezfc-element-option-image",function(){P(this).hasClass("ezfc-element-radio-image")?H.radio_change_state(P(this).siblings(".ezfc-element-radio-input")):P(this).hasClass("ezfc-element-checkbox-image")&&H.checkbox_change_state(P(this).siblings(".ezfc-element-checkbox-input"))}),P(document).on("click",".ezfc-element-option-has-image label",function(){var e=P(this).closest(".ezfc-element").data("element"),t=P(this).closest(".ezfc-element-single-option-container").find(":input");"radio"==e?H.radio_change_state(t):"checkbox"==e&&H.checkbox_change_state(t,null,!1,!0)}),P(".ezfc-addon-option").click(function(){P(this).siblings(".ezfc-element-option-image").click()}),P(".ezfc-form").each(function(){var e=P(this),t=e.closest(".ezfc-wrapper");H.init_form(e),H.init_form_ui(e),t.find(".ezfc-form-loading-text").length&&t.find(".ezfc-form-loading-text").fadeOut(500,function(){e.fadeIn(500,function(){t.removeClass("ezfc-form-loading"),H.form_change(e),H.scroll()})}),P(document).trigger("ezfc_forms_loaded")}),P(".ezfc-element-fileupload").each(function(e,a){var r=P(this).closest(".ezfc-element"),n=r.find(".ezfc-upload-button"),s=r.find(".ezfc-fileupload-files"),o=r.data("id"),t=(P(this).attr("multiple"),P(this).closest(".ezfc-form")),c=t.find("input[name='id']").val(),l=t.find("input[name='ref_id']").val(),i={action:"ezfc_frontend_fileupload",data:"action=upload_file&id="+c+"&ref_id="+l};if("function"!=typeof P.prototype.fileupload)return H.debug_message("Unable to load fileupload function."),!1;P(this).fileupload({formData:i,dataType:"json",add:function(e,t){r.find(".ezfc-bar").css("width",0),r.find(".progress").addClass("active"),r.find(".ezfc-fileupload-message").text(""),n.off("click"),1==H.get_element_object_value(o,"file_upload_auto",1)?H.file_upload_attach_event(a,t,n,e):n.click(function(){H.file_upload_attach_event(a,t,n,e)})},done:function(e,t){if(n.removeAttr("disabled"),t.result.error)return r.find(".ezfc-fileupload-message").text(t.result.error),r.find(".ezfc-bar").css("width",0),!1;for(var a in void 0===H.uploaded_files[c]&&(H.uploaded_files[c]=[]),void 0===H.uploaded_files[c][o]&&(H.uploaded_files[c][o]=[]),t.result)H.uploaded_files[c][o].push({id:t.result[a].success,name:t.files[a].name});P(this).val(""),P(this).attr("multiple")||P(this).attr("disabled","disabled"),r.find(".progress").removeClass("active"),r.find(".ezfc-fileupload-message").text(ezfc_vars.upload_success);var i="";for(var a in H.uploaded_files[c][o])i+="<li class='ezfc-fileupload-files-item' data-fileid='"+H.uploaded_files[c][o][a].id+"' data-refid='"+l+"'>"+H.uploaded_files[c][o][a].name+" <span class='ezfc-fileupload-files-remove'><i class='fa fa-close'></i></span></li>";s.html(i)},progressall:function(e,t){var a=parseInt(t.loaded/t.total*100,10);P(r).find(".ezfc-bar").css("width",a+"%")},replaceFileInput:!1,url:ezfc_vars.ajaxurl})}),P(document).on("click",".ezfc-fileupload-files-remove",function(){var i=P(this);if(i.hasClass("ezfc-state-removing"))return!1;var r=i.closest(".ezfc-form").find("input[name='id']").val(),n=i.closest(".ezfc-element"),s=i.closest(".ezfc-fileupload-files-item"),o=n.find(".ezfc-fileupload-message"),c=n.find(".ezfc-element-fileupload"),l=n.data("id"),_=s.data("fileid"),e=s.data("refid"),t="action=remove_uploaded_file&file_id="+_+"&ref_id="+e;return i.addClass("ezfc-state-removing"),i.find(".fa").removeClass("fa-close").addClass("fa-circle-o-notch fa-spin"),P.ajax({type:"post",url:ezfc_vars.ajaxurl,data:{action:"ezfc_frontend_fileupload",data:t},complete:function(e){var t;if("object"==typeof e&&void 0!==e.responseText)try{t=P.parseJSON(e.responseText)}catch(e){}if(!t)return o.text(e.upload_remove_error),i.find(".fa").removeClass("fa-circle-o-notch fa-spin ezfc-state-removing").addClass("fa-close"),!1;c.attr("multiple")||1==n.find(".ezfc-fileupload-files-item").length&&c.removeAttr("disabled");for(var a in s.fadeOut(),o.text(ezfc_vars.upload_removed),H.uploaded_files[r][l])H.uploaded_files[r][l][a].id==_&&H.uploaded_files[r][l].splice(a,1)}}),!1}),P(".ezfc-overview").dialog({autoOpen:!1,modal:!0}),P(".ezfc-form .ezfc-input-format-listener").each(function(){H.input_format_listener_change(P(this)),P(this).trigger("ezfc_blur_trigger")});var e=this.throttle(function(e){var t=e.parents(".ezfc-form");H.form_change(t,null,e)},100);P(document).on("change keyup",".ezfc-form input, .ezfc-form select",function(){e(P(this))}),P(".ezfc-element-wrapper-checkbox").change(function(){H.checkbox_change(P(this))}),P(document).on("click",".ezfc-element-wrapper-radio :input",function(){H.radio_change_state(P(this),!0)}),P(".ezfc-slider").each(function(e,t){var r=P(this),n=P(this).data("id"),s=(H.get_element_object(n),P(this).closest(".ezfc-form").data("id")),a=P(t).siblings(".ezfc-slider-element"),i=r.hasClass("ezfc-slider-vertical")?"vertical":"horizontal",o=H.normalize_value(r.val(),r),c={min:r.data("min")||0,max:r.data("max")||100,step:r.data("stepsslider")||1,value:o||0,orientation:i},l=r.data("values"),_=null;if(l)for(var d in _=String(l).split(","),_=P.map(_,P.trim),c.min=0,c.max=_.length-1,_)_[d]==o&&(c.value=d);c.slide=function(e,t){var a=t.value;_&&void 0!==_[t.value]&&(a=_[t.value]);var i=H.format_price(s,a,!1,!1,!1,!0);r.val(i),r.trigger("change")},c.start=function(e,t){r.trigger("focus")},c.stop=function(e,t){var a=t.value;_&&void 0!==_[t.value]&&(a=_[t.value]);var i=H.format_value_element(n,a);r.val(i),r.trigger("change"),r.trigger("blur")};var f=a.slider(c);if(P(document).on("change keyup",r,function(){var e=H.normalize_value(r.val(),r),t=e;if(_)for(var a in _){H.normalize_value(e,r);e==_[a]&&(t=a)}f.slider("value",t)}),r.hasClass("ezfc-pips")){var u={rest:"label"};_&&(u.labels=_),isNaN(r.data("stepspips"))||""==r.data("stepspips")||(u.step=r.data("stepspips")),a.slider("pips",u),a.find(".ui-slider-pip").on("click",function(){var e=P(this).find(".ui-slider-label").data("value");_&&void 0!==_[e]&&(e=_[e]),e=H.format_price(s,e,!1,!1,!1,!0),r.val(e),r.trigger("change"),r.trigger("blur")}),1==r.data("pipsfloat")&&a.slider("float")}}),P(".ezfc-spinner").each(function(e,t){var r=P(this),n=P(this).data("id"),a=P(this).closest(".ezfc-form").data("id");r.data("stepsspinner");r.spinner({min:r.data("min")||0,max:r.data("max")||100,step:r.data("stepsspinner")||1,change:function(e,t){},spin:function(e,t){H.format_price(a,t.value,!1,!1,!1,!1)},start:function(e,t){var a=r.val(),i=H.normalize_value(a);r.val(i)},stop:function(e,t){var a=r.val();a=H.normalize_value(a,P(this));var i=H.format_value_element(n,a);r.val(i),r.trigger("change")}})}),P(document).on("click",".ezfc-step-button",function(){var e=P(this).parents(".ezfc-form"),t=parseInt(e.find(".ezfc-step-active").data("step"))+(P(this).hasClass("ezfc-step-next")?1:-1),a=P(this).hasClass("ezfc-step-next")?1:0;return H.set_step(e,t,a),!1}),P(document).on("click",".ezfc-step-indicator-item-active, .ezfc-step-indicator-item-force",function(){var e=P(this).closest(".ezfc-form"),t=parseInt(P(this).data("step"));return H.set_step(e,t,0),!1}),P(document).on("change",".ezfc-element-wrapper-payment input",function(){var e=P(this).closest(".ezfc-form"),t=e.data("id");1!=H.form_vars[t].price_show_request&&1!=H.form_vars[t].summary_enabled&&H.set_submit_text(e)}),P(window).scroll(this.scroll),this.scroll(),P(".ezfc-form").submit(function(e){var t=P(this),a=t.data("id"),i=t.find(".ezfc-submit");return 1==H.form_vars[a].hard_submit||(H.form_submit(t,-1,i.data("type")),e.preventDefault(),!1)}),P(".ezfc-payment-submit").click(function(e){var t=P(this).closest(".ezfc-payment-form").data("form_id"),a=P(".ezfc-form[data-id='"+t+"']");return H.form_submit(a,-1,P(this).data("payment")),e.preventDefault(),!1}),P(".ezfc-payment-cancel").click(function(){var e=P(this).closest(".ezfc-payment-form").data("form_id"),t=P("#ezfc-form-"+e),a=".ezfc-payment-dialog-modal[data-form_id='"+e+"']";return P(a+=", .ezfc-payment-form").removeClass("ezfc-payment-dialog-open"),H.form_submit(t,!1,!1,!0),!1}),P(".ezfc-reset").click(function(){var e=P(this).parents(".ezfc-form");return H.reset_form(e),!1}),P(".ezfc-collapse-title-wrapper").on("click",function(){var e=P(this).closest(".ezfc-element-wrapper-group");H.toggle_group(e)}),P(".ezfc-cc-number-formatter").on("change keyup",function(){var e=P(this).val();e=e.replace(/[^\dA-Z]/g,"").replace(/(.{4})/g,"$1 ").trim(),P(this).val(e)}),P(".ezfc-table_order-btn").on("click",function(){var e=P("#"+P(this).data("target"));if(e.is(":disabled"))return!1;var t=e.closest(".ezfc-custom-element").closest(".ezfc-form").data("id"),a=e.data("min"),i=e.data("max"),r=P(this).data("value"),n=H.normalize_value(e.val())+r;return 0==i&&(i=n),n=Math.min(n,i),n=Math.max(n,a),e.val(n),e.trigger("blur"),H.form_change(null,t),!1}),P(".ezfc-element-table_order-quantity-input").on("blur",function(){var e=P(this).closest(".ezfc-custom-element").closest(".ezfc-form").data("id"),t=P(this).data("min"),a=P(this).data("max"),i=H.normalize_value(P(this).val());0==a&&(a=i),i=Math.min(i,a),i=Math.max(i,t),P(this).val(i),H.form_change(null,e)}),P(".ezfc-group-repeat").on("click",function(){return H.group_repeat(P(this).data("group_repeat_id")),!1}),P(".ezfc-form-open-popup-button").click(function(){var e=P(this).data("target");return H.popup_form_open(e),!1}),P(".ezfc-form-popup-close").click(function(){var e=P(this).data("target");return H.popup_form_close(e),!1})},this.init_form_ui=function(e,t){void 0===t&&(t=!0);var s=P(e),o=s.data("id");s.find(".ezfc-element-datepicker").each(function(){var e=P(this),t={};e.data("settings")&&(t=e.data("settings"));var i=[0,1,2,3,4,5,6];t.available_days.length&&(i=t.available_days.split(",")),i=i.map(function(e){return parseInt(e)});var r=[];t.blocked_days.length&&(r=t.blocked_days.split(","));var a=P.trim(H.form_vars[o].datepicker_format);""==a&&(a="dd/mm/yy");var n=P.trim(t.yearRange);""==n&&(n="c-10:c+10"),e.datepicker({changeMonth:!!t.changeMonth&&t.changeMonth,changeYear:!!t.changeYear&&t.changeYear,dateFormat:a,firstDay:!!t.firstDay&&t.firstDay,minDate:t.minDate?t.minDate:"",maxDate:t.maxDate?t.maxDate:"",numberOfMonths:t.numberOfMonths?parseInt(t.numberOfMonths):1,showAnim:t.showAnim?t.showAnim:"fadeIn",showWeek:"1"==t.showWeek&&t.showWeek,yearRange:n,beforeShowDay:function(e){return H.check_datepicker_days(e,i,r)}}),e.on("change keyup",function(){var e=P(this).datepicker("getDate"),t=H.check_datepicker_days(e,i,r),a=!0;"object"!=typeof t||t[0]||(a=!1),a||P(this).val(""),H.form_change(s)}),H.check_datepicker_predefined_values(e)}),s.find(".ezfc-element-daterange").each(function(){var n=P(this),e=n.closest(".ezfc-element-daterange-container").data("settings"),t=[0,1,2,3,4,5,6];e.available_days.length&&(t=e.available_days.split(",")),t=t.map(function(e){return parseInt(e)});var a=[];e.blocked_days.length&&(a=e.blocked_days.split(","));var s=P.trim(H.form_vars[o].datepicker_format);""==s&&(s="dd/mm/yy");var i=P.trim(e.yearRange);""==i&&(i="c-10:c+10"),n.hasClass("ezfc-element-daterange-from")?n.datepicker({changeMonth:!!e.changeMonth&&e.changeMonth,changeYear:!!e.changeYear&&e.changeYear,dateFormat:s,firstDay:!!e.firstDay&&e.firstDay,minDate:n.data("mindate"),maxDate:n.data("maxdate"),numberOfMonths:e.numberOfMonths?parseInt(e.numberOfMonths):1,showAnim:e.showAnim?e.showAnim:"fadeIn",showWeek:"1"==e.showWeek&&e.showWeek,yearRange:i,onSelect:function(e){var t=n.data("mindays")||0,a=n.data("maxdays")||0,i=P.datepicker.parseDate(s,e);i.setDate(i.getDate()+t);var r=P.datepicker.parseDate(s,e);r.setDate(r.getDate()+a),n.siblings(".ezfc-element-daterange-to").datepicker("option","minDate",i),0!=a&&n.siblings(".ezfc-element-daterange-to").datepicker("option","maxDate",r),n.trigger("change")},beforeShowDay:function(e){return H.check_datepicker_days(e,t,a)}}):n.datepicker({changeMonth:!!e.changeMonth&&e.changeMonth,changeYear:!!e.changeYear&&e.changeYear,dateFormat:s,firstDay:!!e.firstDay&&e.firstDay,minDate:n.data("mindate"),maxDate:n.data("maxdate"),numberOfMonths:e.numberOfMonths?parseInt(e.numberOfMonths):1,showAnim:e.showAnim?e.showAnim:"fadeIn",showWeek:"1"==e.showWeek&&e.showWeek,yearRange:i,onSelect:function(e){n.trigger("change")},beforeShowDay:function(e){return H.check_datepicker_days(e,t,a)}}),H.check_datepicker_predefined_values(n)}),s.find(".ezfc-element-timepicker").each(function(){H.init_timepicker(P(this),o)}),s.find(".ezfc-element-colorpicker").each(function(){var t=P(this),a=t.parents(".ezfc-element").find(".ezfc-element-colorpicker-input"),e=t.colorpicker({container:t}).on("changeColor.colorpicker",function(e){t.css("background-color",e.color.toHex()),a.val(e.color.toHex())});P(a).on("click focus",function(){e.colorpicker("show")}).on("change",function(){e.colorpicker("setValue",s.val())})});var a=s.find(".ezfc-step");if(0<a.length){var i=a.last();s.find(".ezfc-summary-wrapper").appendTo(i),s.find(".ezfc-submit-wrapper").appendTo(i).addClass("ezfc-submit-step"),this.prevent_enter_step_listener(i.find("input"),s)}H.init_form(e)},this.init_timepicker=function(e,t,a){var i={};e.data("settings")&&(i=e.data("settings")),"object"==typeof a&&(i=P.extend({},i,a));var r=i.format?i.format:H.form_vars[t].timepicker_format;""==r&&(r="H:i"),e.timepicker({disableTimeRanges:i.disabledTimes?i.disabledTimes:[],minTime:i.minTime?i.minTime:null,maxTime:i.maxTime?i.maxTime:null,step:i.steps?i.steps:30,timeFormat:r})},this.init_form=function(e){var t=P(e),i=t.data("id");if(this.set_ref_id(i),this.form_vars[i]=t.data("vars"),"object"!=typeof this.form_vars[i]&&(this.form_vars[i]=P.parseJSON(t.data("vars"))),P.each(H.form_vars[i].form_elements_order,function(e,t){var a={$element:P("#ezfc_element-"+H.form_vars[i].form_elements_order[e]),$element_input:P("#ezfc_element-"+H.form_vars[i].form_elements_order[e]).find("input, textarea"),id:t,form_id:i};H.$form_elements[t]=a}),this.subtotals[i]=[],this.conditional_once[i]=[],this.external_listeners[i]=[],this.elements_cache[i]=[],this.current_steps[i]=0,this.trigger_list[i]=[],1==this.form_vars[i].price_show_request&&this.price_request_toggle(i,!1),this.price_old_global[i]=0,this.set_price(t),this.set_submit_text(t),this.form_vars[i].use_woocommerce){P(".woocommerce form.cart, .woocommerce .price").hide()}1<parseInt(this.form_vars[i].step_indicator_start)+1&&t.find(".ezfc-step-indicator").hide(),2!=ezfc_vars.debug_mode||P("#ezfc-show-all-elements").length||(t.append("<button id='ezfc-show-all-elements'>Show/hide elements</button>"),P("#ezfc-show-all-elements").click(function(){return t.hasClass("ezfc-debug-visible")?(t.removeClass("ezfc-debug-visible"),t.find(".ezfc-tmp-visible").removeClass("ezfc-tmp-visible").hide()):(t.addClass("ezfc-debug-visible"),t.find(".ezfc-hidden").addClass("ezfc-tmp-visible").show().css("display","inline-block")),!1})),1==this.form_vars[i].use_stripe&&"undefined"!=typeof Stripe&&Stripe.setPublishableKey(ezfc_vars.stripe.publishable_key),this.prevent_enter_step_listener(":input:not(textarea):not([type=submit])",t),this.populate_html_placeholders(t),1==this.form_vars[i].popup_open_auto&&this.popup_form_open(i),this.init_table_order(i),P(document).trigger("ezfc_form_init",i)},this.form_change=function(e,t,a){e=e||P("#ezfc-form-"+t),t=t||P(e).data("id"),this.trigger_list[t]=[];var i=0;if(this.$element_trigger=a){i=a.data("id"),a.hasClass("ezfc-custom-element")||(i=a.closest(".ezfc-custom-element").data("id"));var r=this.get_element_object(i);if(!r.hasOwnProperty("trigger_ids")||r.trigger_ids.length<1)return;this.form_build_trigger_list(t,r.id)}this.clear_hidden_values(e),this.form_vars[t].price_requested=0,this.form_vars[t].summary_shown=0,P(e).find(".ezfc-summary-wrapper").fadeOut(),1==this.form_vars[t].price_show_request&&this.price_request_toggle(t,!1),this.remove_debug_info(),this.set_price(e),this.set_submit_text(e),this.populate_html_placeholders(e),this.live_summary_update(t),this.call_hook("ezfc_after_form_change",{form_id:t})},this.form_build_trigger_list=function(e,t){var a=this.get_element_object(t),i=[t];P.each(a.trigger_ids,function(e,t){var a=H.get_element_object(t);i=i.concat(a.trigger_ids)}),this.trigger_list[e]=this.unique(i)},this.form_submit=function(p,h,e,t){var v=P(p),g=v.closest(".ezfc-wrapper"),b=v.data("id"),r=!1;v.find(".ezfc-submit-icon").addClass("ezfc-submit-icon-show");var z=v.find(".ezfc-submit-icon, .ezfc-step-submit-icon"),y=v.find("input[type='submit']");if(1==this.form_vars[b].price_show_request&&this.set_price(p),t)return H.submit_cancel(v),!1;if(-1!==P.inArray(e,H.payment_methods)){var a=P("#ezfc-"+e+"-form-"+b),i=this.format_price(b,this.price_old_global[b],!1,!1,!0);if(a.find(".ezfc-payment-price").text(i),H.form_vars[b].payment_info_shown[e]){if(H.payment_form_id=b,a.find(".ezfc-payment-submit, .ezfc-payment-cancel").prop("disabled",!0),"stripe"==e)Stripe.card.createToken(a,this.stripe_response_handler);else if("authorize"==e){if("undefined"==typeof Accept)return H.debug_message("AcceptJS wasn't loaded."),!1;this.authorize_create_token(b)}}else H.form_vars[b].payment_info_shown[e]=1,P("#ezfc-"+e+"-form-"+b+", #ezfc-"+e+"-form-modal-"+b).addClass("ezfc-payment-dialog-open");return z.fadeOut(),!1}z.fadeIn(),y.prop("disabled",!0),v.find(".ezfc-custom-hidden:not(.ezfc-element-wrapper-fileupload):not(.ezfc-element-wrapper-group)").each(function(){var e=P(this).find(".ezfc-element-radio:not(:has(:radio:checked))");e.length&&P(e).first().find("input").prop("checked",!0),P(this).find("option").first().prop("checked",!0).val(f),P(this).find(".ezfc-element-checkbox-input").first().prop("checked",!0).addClass("ezfc-has-hidden-placeholder").val(f),P(this).find(":input").val(f).removeAttr("disabled").addClass("ezfc-has-hidden-placeholder")});var n="";for(var s in ezfc_vars.element_vars[b]){var o=ezfc_vars.element_vars[b][s].id,c=this.get_element_object_value(o,"calculate_enabled",1),l=H.element_is_visible(o);if(l&&(n+="&elements_visible["+o+"]=1"),0==c&&!l)this.get_element_child_input_dom(o).val(f);n+="&calculated_values["+o+"]="+EZFC.get_calculated_element_value(b,o)}v.find(".ezfc-element-wrapper-checkbox").each(function(){if(P(this).find(".ezfc-has-hidden-placeholder").length)return!1;var e=P(this),t=parseInt(e.attr("data-min_selectable")),a=parseInt(e.attr("data-max_selectable")),i=e.find(":checked").length;return 0<t&&i<t?(r=!0,H.show_tip(e,"#"+e.attr("id"),0,H.sprintf(H.form_vars[b].selectable_min_error,t)),!1):0<a&&a<i?(r=!0,H.show_tip(e,"#"+e.attr("id"),0,H.sprintf(H.form_vars[b].selectable_max_error,a)),!1):void 0});var _=[];v.find("[data-is_number='1'] input").each(function(){this.value!=f&&(_.push({element:P(this),value:this.value}),this.value=this.value.replace(/[^0-9\.,-\\%]/g,""))});var k=v.serialize();if(k+=n,P.each(_,function(e,t){P(t.element).val(t.value)}),r)return z.fadeOut(),y.removeAttr("disabled"),!1;P(".ezfc-element[data-min], .ezfc-element[data-max]").each(function(){var e=P(this).closest(".ezfc-custom-element").data("id"),t=P(this).data("min"),a=P(this).data("max"),i="&dynamic_min["+e+"]="+t;k+=i+="&dynamic_max["+e+"]="+a}),k+="&url="+encodeURI(window.location.href),0==this.form_vars[b].price_requested&&(k+="&price_requested=1"),0==this.form_vars[b].summary_shown&&(k+="&summary=1"),-1!=h&&(k+="&step="+h),this.form_vars[b].preview_form&&(k+="&preview_form="+this.form_vars[b].preview_form);var d=this.price_old_global[b];1==this.form_vars[b].price_show_request&&(d=H.functions.calculate_price(b)),k+="&generated_price="+d,this.call_hook("ezfc_before_submission",{data:k,form:v,form_vars:this.form_vars[b],id:b}),P.ajax({type:"post",url:ezfc_vars.ajaxurl,data:{action:"ezfc_frontend",data:k},success:function(t){P(".ezfc-submit-icon").removeClass("ezfc-submit-icon-show"),y.removeAttr("disabled"),z.fadeOut(),H.debug_message(t);try{t=P.parseJSON(t)}catch(e){t=!1,H.debug_message(e)}if(!t)return P("#ezfc-message-"+b).text(ezfc_vars.form_submit_error),H.recaptcha_reload(),H.reset_disabled_fields(p,!0),!1;if(void 0!==t.error){if(H.reset_disabled_fields(p,!0),t.id){var e=!0,a="#ezfc_element-"+t.id,i=P(a).find(".ezfc-element").first(),r=0<v.find(".ezfc-step-active").length;if(r)parseInt(P(a).parents(".ezfc-step").data("step"))!=h&&-1!=h&&(e=!1,H.set_step(p,h+1));if(e){i.length||(i=P(a));var n=r?1e3:400,s=0<g.find(".ezfc-payment-dialog-open").length;if(i.is(":visible"))H.show_tip(i,a,n,t.error),s&&H.set_message(b,t.error+" (#"+t.id+")");else{var o=i.parents(".ezfc-element-wrapper-group");o.length?(o.each(function(e,t){H.toggle_group(P(t),!0)}),H.show_tip(i,a,n,t.error)):H.set_message(b,t.error+" (#"+t.id+")")}if(void 0!==ezfc_vars.required_text_auto_hide){var c=1e3*parseFloat(ezfc_vars.required_text_auto_hide);0<c&&setTimeout(function(){null},c)}0==H.form_vars[b].disable_error_scroll&&H.scroll_to(a)}}else H.set_message(b,t.error);return H.recaptcha_reload(),!1}if(t.step_valid)return H.reset_disabled_fields(p),H.set_step(p,h+1),!1;if(t.summary)return v.find(".ezfc-summary-wrapper").fadeIn().find(".ezfc-summary").html(t.summary),H.form_vars[b].summary_shown=1,H.reset_disabled_fields(p),!1;if(H.recaptcha_reload(),t.paypal)y.attr("disabled","disabled"),window.location.href=t.paypal;else{if(t.price_requested||0===t.price_requested)return H.price_request_toggle(b,!0,t.price_requested),!1;var l={data:k,form:v,form_vars:H.form_vars[b],id:b,price:price,response:t};H.call_hook("ezfc_submission_success",l),H.form_vars[b].submission_js_func&&"function"==typeof window[H.form_vars[b].submission_js_func]&&window[H.form_vars[b].submission_js_func](l),g.find(".ezfc-payment-dialog, .ezfc-payment-dialog-modal").removeClass("ezfc-payment-dialog-open");var _=P(".ezfc-success-text[data-id='"+b+"']");if(_.html(t.success),H.set_ref_id(b),1==H.form_vars[b].reset_after_submission){H.reset_form(p);var d=1e4;return H.object_has_property(H.form_vars[b],"show_success_text_duration")&&(d=1e3*parseFloat(H.form_vars[b].show_success_text_duration)),0==d&&(d=99999999999),void _.fadeIn().delay(d).fadeOut()}1==H.form_vars[b].hide_all_forms?P(".ezfc-form, .ezfc-required-notification").fadeOut().addClass("ezfc-form-submitted"):(v.find(".ezfc-required-notification").fadeOut(),1==H.form_vars[b].show_success_text&&v.fadeOut().addClass("ezfc-form-submitted")),1==H.form_vars[b].show_success_text&&(1==H.form_vars[b].scroll_to_success_message?_.fadeIn(400,function(){H.scroll_to(_,-200)}):_.fadeIn()),t.woo_update_cart&&(P(document.body).trigger("wc_fragment_refresh"),H.call_hook("ezfc_wc_submission_success",l));var f=Math.max(0,Math.abs(parseInt(H.form_vars[b].redirect_timer)));if(void 0!==H.form_vars[b].redirect_url&&0<H.form_vars[b].redirect_url.length){var u="";1==H.form_vars[b].redirect_forward_values&&(u=v.serialize(),u+="&total="+H.price_old_global[b],u+="&total_f="+H.functions.price_format(b,H.price_old_global[b]));var m=-1==H.form_vars[b].redirect_url.indexOf("?")?"?":"&";setTimeout(function(){window.location.href=H.form_vars[b].redirect_url+m+u},1e3*f)}else void 0!==H.form_vars[b].refresh_page_after_submission&&1==H.form_vars[b].refresh_page_after_submission&&setTimeout(function(){window.location.reload()},1e3*f)}}}).fail(function(e,t,a){return H.debug_message({jqXHR:e,testStatus:t,errorThrown:a}),H.set_message(b,ezfc_vars.form_submit_error),H.submit_cancel(v),!1})},this.calculate_get_external_values=function(e,t,a,i){if(a){var r,n=a.data("value_external"),s=a.data("value_external_listen");if(!this.external_listeners[t][n]||s)if(n&&0<P(n).length)r=P(n).is("input[type='radio']")?P(n).find(":checked").val():P(n).is("input, input[type='text'], textarea")?P(n).val():P(n).is("select")?P(n).find(":selected").text():P(n).text(),"input"==i||"numbers"==i||"subtotal"==i?a.find("input").val(r):"dropdown"==i?(a.find(":selected").removeAttr("selected"),a.find("option[value='"+r+"']").attr("selected","selected")):"radio"==i||"checkbox"==i?(a.find(":checked").removeAttr("checked"),a.find("input[value='"+r+"']").attr("checked","checked")):"textfield"==i&&a.find("textarea").val(r),this.external_listeners[t][n]||(this.external_listeners[t][n]=1,P(n).on("change keyup",function(){H.set_price(P(e))}))}},this.calculate_conditionals=function(e,f,u,m,t){var p=this.get_element_object(u),h=this.get_element_dom(u);if(u&&void 0!==p.conditional||t){var v=p.conditional;if(t&&(v=u),v){var g=this.get_value_from_element(h,null,0==p.is_number),a=this.get_element_object_value(p,"factor",1);for(var b in v.action){var i=v.action[b];if(i&&0!=i){var z,r=v.target[b],n=H.get_element_object(r);if((z="submit_button"==v.target[b]?P(e).find(".ezfc-submit"):"price"==v.target[b]?P(e).find(".ezfc-price-wrapper-element"):H.get_element_dom(r))&&!(z.length<1&&v.redirects.length<1)){1==v.use_factor[b]&&(a=parseFloat(a),isNaN(a)||(g*=a));var s=[{operator:v.operator[b],value:v.values[b],compare_target:H.get_object_value(v,"compare_value_first","",b)}];void 0!==v.chain&&void 0!==v.chain[b]&&(v.chain[b].operator,1)&&P.each(v.chain[b].operator,function(e,t){s.push({operator:v.chain[b].operator[e],value:v.chain[b].value[e],compare_target:v.chain[b].compare_target[e]})});var y=!1,k=0;P.each(s,function(e,t){var a=!1,i=t.value,r=[],n=g,s=p;if(0!=t.compare_target&&""!=t.compare_target&&(n=H.get_value_from_element(!1,t.compare_target),s=H.get_element_object(t.compare_target)),"__self__"==t.value&&(t.value=g),i=1==p.is_number&&-1===P.inArray(t.operator,R)?parseFloat(t.value):t.value,"between"!=t.operator&&"not_between"!=t.operator||1<(r=t.value.split(":")).length&&(r[0]=parseFloat(r[0]),r[1]=parseFloat(r[1])),"datepicker"==s.type&&(i=new Date(i)),"input"==m)a=i.toLowerCase()==z.val().toLowerCase();else switch(t.operator){case"gr":a=i<n;break;case"gre":a=i<=n;break;case"less":a=n<i;break;case"lesse":a=n<=i;break;case"equals":a=n==i;break;case"between":a=!(r.length<2)&&(n>=r[0]&&n<=r[1]);break;case"not_between":a=!(r.length<2)&&(n<r[0]||n>r[1]);break;case"not":a=r.length<2?n!=i:n<r[0]&&n>r[1];break;case"hidden":a=!H.element_is_visible(u);break;case"visible":a=H.element_is_visible(u);break;case"mod0":a=0<n&&n%i==0;break;case"mod1":a=0<n&&n%i!=0;break;case"bit_and":a=n&i;break;case"bit_or":a=n|i;break;case"empty":void 0===n&&(a=!0),a="number"==typeof n?isNaN(n):n.length<1;break;case"notempty":a=void 0!==n&&("number"==typeof n?!isNaN(n):0<n.length);break;case"in":if(void 0===n)a=!1;else{var o=i.split("|");for(var c in a=!1,o)if(n==o[c])return void(a=!0)}break;case"not_in":if(void 0===n)a=!1;else{o=i.split("|");for(var c in a=!0,o)if(n==o[c])return void(a=!1)}break;case"once":a=!0,void 0===H.conditional_once[f][u]&&(H.conditional_once[f][u]=[]),void 0===H.conditional_once[f][u][b]&&(H.conditional_once[f][u][b]=[]),void 0===H.conditional_once[f][u][b][e]?H.conditional_once[f][u][b][e]=1:a=!1;break;case"selected":case"selected_index":case"selected_id":case"selected_count":case"selected_count_gt":case"selected_count_lt":a=!1;var l="value";"selected_index"==t.operator?l="index":"selected_id"==t.operator?l="option_id":"selected_count"!=t.operator&&"selected_count_gt"!=t.operator&&"selected_count_lt"!=t.operator||(l="count"),a="object"==typeof(_=0!=t.compare_target&&""!=t.compare_target?H.get_value_from_element(!1,t.compare_target,!0,!1,{return_array:!0,return_value:l}):H.get_value_from_element(h,null,!0,!1,{return_array:!0,return_value:l}))?H.conditional_check_multiple_options(i,_):"selected_count"==t.operator?_==i:"selected_count_gt"==t.operator?i<_:"selected_count_lt"==t.operator?_<i:H.conditional_check_multiple_options(i,_);break;case"not_selected":case"not_selected_index":case"not_selected_id":case"not_selected_count":a=!0;var _;l="value";if("not_selected_index"==t.operator?l="index":"not_selected_id"==t.operator?l="option_id":"not_selected_count"==t.operator&&(l="count"),"object"==typeof(_=0!=t.compare_target&&""!=t.compare_target?H.get_value_from_element(!1,t.compare_target,!0,!1,{return_array:!0,return_value:l}):H.get_value_from_element(h,null,!0,!1,{return_array:!0,return_value:l}))){o=i.split("|");for(var c in o)for(var d in cmp_value=o[c],_)if(_[d]==cmp_value)return void(a=!1)}else a=_!=i;break;case"focus":a=0<h.find(".ezfc-slider").length?h.find("input").is(":focus")||0<h.find(".ui-state-active").length:h.find("input").is(":focus");break;case"blur":a=0<h.find(".ezfc-slider").length?!h.find("input").is(":focus")&&h.find(".ui-state-active").length<1:!h.find("input").is(":focus");break;case"always":a=!0;break;case"step_equals":a=H.current_steps[f]==i;break;case"step_gt":a=i<H.current_steps[f];break;case"step_lt":a=H.current_steps[f]<i;break;case"calculate_enabled":a=1==H.get_element_object_value(p,"calculate_enabled",1);break;case"calculate_disabled":a=0==H.get_element_object_value(p,"calculate_enabled",1);break;default:a=!1}if(void 0!==v.row_operator[b]&&1==v.row_operator[b]){if(a)return k++,!(y=!0)}else{if(!a)return;k++}}),0<k&&k==s.length&&(y=!0);var o=v.notoggle[b],c=z.data("element"),l=v.target_value[b];if(l=l.replace(/__self__/gi,g),"group"==c&&z.push(P(z).find("> .ezfc-custom-element")),"set"==i&&y){var _=H.check_inline_math(l,z);if("input"==c||"hidden"==c||"numbers"==c||"subtotal"==c||"set"==c)H.set_element_object_value(r,"current_value",_),H.set_element_object_value(r,"current_value_forced",_),z.find("input").val(_).trigger("blur");else if("dropdown"==c)z.find(":selected").removeAttr("selected"),z.find("option[data-value='"+_+"']").prop("selected","selected");else if("radio"==c)H.radio_change_state(z.find("input[data-value='"+_+"']"),!0,!0);else if("checkbox"==c)H.checkbox_change_state(z.find("input[data-value='"+_+"']"),!0,!0);else if("datepicker"==c){(d=z.find("input.hasDatepicker")).length&&d.datepicker("setDate",l)}else if("daterange"==c){var d;if(1<(d=z.find("input.hasDatepicker")).length){var w=l.split(";;");void 0!==w[0]&&P(d[0]).datepicker("setDate",w[0]),void 0!==w[1]&&P(d[1]).datepicker("setDate",w[1])}}else"image"==c?z.find("img").attr("src",l):z.text(_)}else if("set_factor"==i&&y)H.set_element_object_value(r,"factor",l);else if("select_option"==i&&y){var x=l.split("|");for(var j in x){var C=x[j];"radio"==c?H.radio_change_state(z.find("input[data-optionid='"+C+"']"),!0,!0):"checkbox"==c?H.checkbox_change_state(z.find("input[data-optionid='"+C+"']"),!0,!0):"dropdown"==c&&(z.find(":selected").removeAttr("selected"),z.find("option[data-optionid='"+C+"']").prop("selected","selected"))}}else if("deselect_option"==i&&y){x=l.split("|");for(var j in x){C=x[j];"radio"==c?H.radio_change_state(z.find("input[data-optionid='"+C+"']"),!1,!0):"checkbox"==c?H.checkbox_change_state(z.find("input[data-optionid='"+C+"']"),!1,!0):"dropdown"==c&&z.find(":selected").removeAttr("selected")}}else if("show_option"==i){x=l.split("|");for(var j in x){C=x[j];y?"radio"==c||"checkbox"==c?z.find("input[data-optionid='"+C+"']").closest(".ezfc-element-single-option-container").show():"dropdown"==c&&z.find("option[data-optionid='"+C+"']").removeAttr("hidden"):"radio"==c?(H.radio_change_state(z.find("input[data-optionid='"+C+"']"),!1,!0),z.find("input[data-optionid='"+C+"']").closest(".ezfc-element-single-option-container").hide()):"checkbox"==c?(H.checkbox_change_state(z.find("input[data-optionid='"+C+"']"),!1,!0),z.find("input[data-optionid='"+C+"']").closest(".ezfc-element-single-option-container").hide()):"dropdown"==c&&(z.find(":selected").removeAttr("selected"),z.find("option[data-optionid='"+C+"']").attr("hidden",!0))}}else if("hide_option"==i){x=l.split("|");for(var j in x){C=x[j];y?"radio"==c?(H.radio_change_state(z.find("input[data-optionid='"+C+"']"),!1,!0),z.find("input[data-optionid='"+C+"']").closest(".ezfc-element-single-option-container").hide()):"checkbox"==c?(H.checkbox_change_state(z.find("input[data-optionid='"+C+"']"),!1,!0),z.find("input[data-optionid='"+C+"']").closest(".ezfc-element-single-option-container").hide()):"dropdown"==c&&z.find("option[data-optionid='"+C+"']").attr("hidden",!0).removeAttr("selected"):"radio"==c||"checkbox"==c?z.find("input[data-optionid='"+C+"']").closest(".ezfc-element-single-option-container").show():"dropdown"==c&&z.find("option[data-optionid='"+C+"']").removeAttr("hidden")}}else if("activate"==i){if(y)if("submit"==c)z.prop("disabled",!1);else if("group"==c){var D=H.get_group_children(r);H.set_element_list_object_value(D,"calculate_enabled",1)}else H.set_element_object_value(r,"calculate_enabled",1);else if(1!=o)if("submit"==c)z.prop("disabled",!0);else if("group"==c){D=H.get_group_children(r);H.set_element_list_object_value(D,"calculate_enabled",0)}else H.set_element_object_value(r,"calculate_enabled",0)}else if("activate_option"==i){var N="[data-optionid='"+v.option_index_value[b]+"']";y?z.find(N).prop("disabled",!1).removeClass("force-disabled"):z.find(N).prop("disabled",!0).addClass("force-disabled")}else if("deactivate"==i){if(y)if("submit"==c)z.prop("disabled",!0);else if("group"==c){D=H.get_group_children(r);H.set_element_list_object_value(D,"calculate_enabled",0)}else H.set_element_object_value(r,"calculate_enabled",0);else if(1!=o)if("submit"==c)z.prop("disabled",!1);else if("group"==c){D=H.get_group_children(r);H.set_element_list_object_value(D,"calculate_enabled",1)}else H.set_element_object_value(r,"calculate_enabled",1)}else if("deactivate_option"==i){var F="[data-optionid='"+v.option_index_value[b]+"']";y?z.find(F).prop("disabled",!0).addClass("force-disabled"):z.find(F).prop("disabled",!1).removeClass("force-disabled")}else if("redirect"==i&&y){P(e).parents(".ezfc-wrapper").find(".ezfc-message").text(H.form_vars[f].redirect_text).fadeIn(),P(e).fadeOut(),setTimeout(function(){window.location.href=v.redirects[b]},1e3*H.form_vars[f].redirect_timer)}else if("step_goto"!=i&&"step_prev"!=i&&"step_next"!=i||!y)if("set_min"!=i&&"set_max"!=i||!y)if("set_min_selectable"==i&&y)z.attr("data-min_selectable",l),H.checkbox_change(z);else if("set_max_selectable"==i&&y)z.attr("data-max_selectable",l),H.checkbox_change(z);else if("add_class"==i){z[y?"addClass":"removeClass"](l)}else if("remove_class"==i){z[y?"removeClass":"addClass"](l)}else if("set_color"==i&&y)z.find("input, select, .ezfc-price, .ezfc-element-checkbox-text").css("color",l),"submit"==c&&z.css("color",l);else if("calc_routine_enable"==i){var I=parseInt(l);isNaN(I)||(--I,n.hasOwnProperty("calculate_routine")&&"object"==typeof n.calculate_routine[I]&&(n.calculate_routine[I].activated=y))}else if("calc_routine_enable_name"==i){if(0<l.length&&n.hasOwnProperty("calculate_routine")){var q=H.get_calculation_routine_by_name(n,l);for(var O in q)"object"==typeof n.calculate_routine[q[O]]&&(n.calculate_routine[q[O]].activated=y)}}else if("calc_routine_disable"==i){I=parseInt(l);isNaN(I)||(--I,n.hasOwnProperty("calculate_routine")&&"object"==typeof n.calculate_routine[I]&&(n.calculate_routine[I].activated=!y))}else if("calc_routine_disable_name"==i){if(0<l.length&&n.hasOwnProperty("calculate_routine")){q=H.get_calculation_routine_by_name(n,l);for(var O in q)"object"==typeof n.calculate_routine[q[O]]&&(n.calculate_routine[q[O]].activated=!y)}}else H.call_conditional_action(y,i,z,r,o);else{var A="set_min"==i?"min":"max",M=z.find(":input"),T=parseFloat(l),$=M.data("min"),S=M.data("max");if("set_min"==i&&S<T)continue;if("set_max"==i&&T<$)continue;if(M.data(A,T).trigger("ezfc_blur_trigger"),M.hasClass("ezfc-slider")){var E=z.find(".ezfc-slider-element");void 0!==E.slider&&void 0!==E.slider("instance")&&E.slider("option",A,T)}}else H.set_step_action(f,i,v.target[b])}}}}}},this.conditional_actions={class_hidden:"ezfc-hidden ezfc-custom-hidden",class_visible:"ezfc-fade-in",show:function(e,t,a,i){t.addClass(H.conditional_actions.class_visible).removeClass(H.conditional_actions.class_hidden),"group"==a.type&&t.find(".ezfc-element").addClass(H.conditional_actions.class_visible).removeClass(H.conditional_actions.class_hidden),e||1==i||H.conditional_actions.hide(!0,t,a)},hide:function(e,t,a,i){t.addClass(H.conditional_actions.class_hidden).removeClass(H.conditional_actions.class_visible),"group"==a.type&&t.find(".ezfc-element").addClass(H.conditional_actions.class_hidden).removeClass(H.conditional_actions.class_visible),e||1==i||H.conditional_actions.show(!0,t,a)}},this.call_conditional_action=function(e,t,a,i,r){if(this.conditional_actions.hasOwnProperty(t)){var n=this.get_element_object(i);n&&this.conditional_actions[t](e,a,n,r)}},this.calculate_element=function(p,h,v){!p&&h&&(p=P("#ezfc_element-"+h).closest(".ezfc-form").data("id"));var g=this.get_element_dom(h),b=this.get_element_object(h);if(void 0!==b)if(g){var z=void 0===b.calculate?[]:b.calculate,y=b.calculate_enabled,k=b.add_to_price,w=b.type,x=(H.form_vars[p].has_steps,b.overwrite_price),j=0,C=H.get_value_from_element(g,null,!1);if("subtotal"!=w&&"custom_calculation"!=w&&"extension"!=w||(j=v),"extension"==w&&(z=[]),0!=this.get_element_object_value(b,"calculate_when_zero",1)||0!=j){var e=g.find(".ezfc-element-numbers, .ezfc-element-input-hidden, .ezfc-element-subtotal, .ezfc-element-daterange-container, .ezfc-element-set, .ezfc-element-extension, :selected, :checked, .ezfc-element-custom-calculation, .ezfc-element-table_order"),D=["ceil","floor","round","abs","subtotal"];if(P(e).each(function(e,_){if(void 0!==z&&0!=z.length||"custom_calculation"==w)if(H.element_is_visible(h)||0!=b.calculate_when_hidden||"hidden"==w||"custom_calculation"==w)if(y&&0!=y||z.targets||z.values||"set"==w||"subtotal"==w||"hidden"==w||"extension"==w||"custom_calculation"==w)if(y&&0!=y||"custom_calculation"==w){var t=parseFloat(H.get_element_object_value(b,"factor",1));P(_).val();C&&!isNaN(C)||(C=0),t&&!isNaN(t)||0===t||(t=1);var d=C;switch(w){case"numbers":case"extension":case"hidden":d=C;break;case"dropdown":case"radio":case"checkbox":d=parseFloat(P(_).data("value")),isNaN(d)&&(d=0);break;case"subtotal":d=v;break;case"daterange":var a=[P(_).find(".ezfc-element-daterange-from").datepicker("getDate"),P(_).find(".ezfc-element-daterange-to").datepicker("getDate")];d=H.jqueryui_date_diff(a[0],a[1],1==H.get_element_object_value(b,"workdays_only",0),b)*t;break;case"custom_calculation":var i=P(g).find(".ezfc-element-custom-calculation").data("function");try{d=window[i](j)}catch(e){H.add_debug_info("custom_calculation",g,"--- Custom Calculation Error ---\n"+e),d=0}if(y&&(d=parseFloat(d)),P(g).find(".ezfc-element-custom-calculation-input").val(d),2==ezfc_vars.debug_mode){var r=P(g).find(".ezfc-element-custom-calculation script").text();H.add_debug_info("custom_calculation",g,"custom_calculation:\n"+r)}break;case"table_order":var l=0,f=H.get_element_object(h),u=H.get_element_object_value(f,"table_order_loop_function","");P.each(f.table_order,function(e,t){var a,i=H.normalize_value(P("#"+t.input_id).val()),r="",n=parseFloat(t.value)*i;"function"==typeof window[u]&&(a=window[u](n,i,e,p,h,f));var s=n;"object"==typeof a&&(n=H.get_element_object_value(a,"value",n),r=H.get_element_object_value(a,"text",""));var o=n;s!=n&&(o=s);var c=H.format_price(p,o,null,null,f.is_currency);c+=r,l+=n,P("#"+t.subtotal_id).html(c)}),d=l}!1;var n=[];if(void 0!==z[0]&&(n=z.slice(0)),b.hasOwnProperty("calculate_routine"))for(var s in b.calculate_routine)if(b.calculate_routine[s].activated&&void 0!==z[0])for(var o in b.calculate_routine[s].calculation_rows)n.push(b.calculate_routine[s].calculation_rows[o]);if(void 0!==n[0]){for(var c in z)if("__open__"==z[c].target&&void 0===z[c].reference_index)for(var m in z[c].prio=parseInt(z[c].prio),isNaN(z[c].prio)&&(z[c].prio=0),z)c!=m&&(z[m].prio=parseInt(z[m].prio),isNaN(z[m].prio)&&(z[m].prio=0),"__close__"==z[m].target&&z[c].prio==z[m].prio&&void 0===z[c].reference_index&&void 0===z[m].reference_index&&(z[m].operator=z[c].operator,z[m].reference_index=c,z[c].reference_index=m));P.each(n,function(e,t){if(t.operator&&0!=t.operator||"__close__"==t.target){if("__open__"==t.target)return t.value=d,void(d=0);var a=[],i=[];if(-1===P.inArray(t.operator,D)&&"__open__"!=t.target&&"__close__"!=t.target&&(a=H.get_element_dom(t.target),i=H.get_element_object(t.target),!H.element_is_visible(t.target)&&0==i.calculate_when_hidden))return H.add_debug_info("calculate",g,"#"+e+": Skipping this element as it is conditionally hidden."),void(0==e&&"equals"==t.operator&&(d=0));var r,n=t.value,s=0;if("__close__"==t.target){if(void 0===z[t.reference_index])return;r=d,d=z[t.reference_index].value}else 0<a.length?(s=i.id,void 0===t.use_calculated_target_value&&(t.use_calculated_target_value=0),0==t.use_calculated_target_value?r=H.get_value_from_element(a,null,!1):1==t.use_calculated_target_value?r=H.get_target_subtotal_value(p,s)+H.get_calculated_element_value(p,s):2==t.use_calculated_target_value?r=H.get_calculated_element_value(p,s):3==t.use_calculated_target_value?r=H.get_value_from_element(a,null,!1,!0):4==t.use_calculated_target_value&&(r=H.get_value_from_element(a,null,!0,!1,{return_array:!1,return_value:"count"}))):0!=n&&(r=parseFloat(n));switch(r&&!isNaN(r)||(r=0),""!=b.precision&&(r=parseFloat(H.roundTo(r,b.precision))),t.operator){case"add":d+=r;break;case"subtract":d-=r;break;case"multiply":d*=r;break;case"divide":0==r?(H.add_debug_info("calculate",g,"#"+e+": Division by 0."),d=0):(d/=r,"1"==P(_).data("calculate_before")&&(x=1,d=r/C));break;case"equals":d=r;break;case"power":d=Math.pow(d,r);break;case"ceil":d=Math.ceil(d);break;case"floor":d=Math.floor(d);break;case"min":d=Math.min(d,r);break;case"max":d=Math.max(d,r);break;case"minmax":var o=String(n).split(":");if(o.length<2)return;d=Math.max(Math.min(d,o[1]),o[0]);break;case"round":d=Math.round(d);break;case"roundx":d=H.roundTo(d,r);break;case"abs":d=Math.abs(d);break;case"subtotal":d=v;break;case"log":if(0==r)return;d=Math.log(r);break;case"log2":if(0==r)return;d=Math.log2(r);break;case"log10":if(0==r)return;d=Math.log10(r);break;case"sqrt":d=Math.sqrt(d);break;case"function":var c=H.get_element_object_value(t,"data","");if(c.length&&"function"==typeof window[c]){var l=parseFloat(window[c](d,r));isNaN(l)||(d=l)}}H.add_debug_info("calculate",g,"#"+e+": operator = "+t.operator+"\ntarget_value = "+r+"\ntarget_element = #"+s+"\ncalc_value = "+n+"\naddPrice = "+d)}else H.add_debug_info("calculate",g,"#"+e+": No operator found here.")})}1==k?j+=d:2==k&&(j=d),1==x&&(j=d),H.add_debug_info("calculate",g,"===\nprice = "+j+"\naddPrice = "+d+"\nloop_price = "+v+"\nvalue = "+C+"\nfactor = "+t)}else H.add_debug_info("calculate",g,"Calculation is disabled.");else H.add_debug_info("calculate",g,"No target or values were found to calculate with. Subtotal, Hidden and Set elements are skipped.");else H.add_debug_info("calculate",g,"Skipped as element is hidden and calculate_when_hidden is not enabled.")}),void 0!==b.inline_calculation&&"function"==typeof window[b.inline_calculation])try{j=window[b.inline_calculation](j),H.add_debug_info("calculate",g,"===\ninline calculation = "+j)}catch(e){H.add_debug_info("calculate",g,"===\nInvalid inline calculation!")}1==this.get_element_object_value(b,"force_use_value_enabled",0)&&(j=this.get_element_object_value(b,"force_use_value",0));var t=this.get_element_object_value(b,"min",""),a=this.get_element_object_value(b,"max","");return""!=t&&(t=parseFloat(t),j=Math.max(t,j)),""!=a&&(a=parseFloat(a),j=Math.min(a,j)),j}}else this.debug_message("Unable to find element #"+h,2)},this.calculate_element_loop=function(e,t,a,i){var r,n=this.get_element_object(e),s=(this.get_element_dom(e),n.form_id),o=n.calculate_enabled,c=n.overwrite_price,l=n.add_to_price,_=0;if(0==o?_=0:1==o&&(_=this.calculate_element(s,e,a),_=this.calculate_discounts(e,_,_),1<=l?1==c?a=_:a+=_:1==c&&(r=_)),("subtotal"==t||"set"==t||"custom_calculation"==t)&&!i){var d=this.get_element_child_input_dom(e);0==o?r=0:1==o&&(r=1==l&&1==c?a:_),d.val(r),d.data("converted",0),this.set_element_object_value(n,"current_value_forced",r)}return a},this.calculate_discounts=function(e,s,t){var o=this.get_element_object(e),c=this.get_element_dom(e),a=this.get_element_child_input_dom(e),l=this.get_element_object_value(o,"overwrite_price",0);if(!o||!e||!this.object_has_property(o,"discount"))return s;var i=o.discount;if(i){var _,d=i.range_min,f=i.range_max,r=i.operator,u=i.values,n=this.get_element_object_value(o,"discount_value_type","calculated"),m=this.get_element_object_value(o,"discount_value_apply","calculated"),p=0,h=this.get_element_object_value(o,"factor_default",1);if(h&&!isNaN(h)||0===h||(h=1),H.set_element_object_value(o,"factor",h),"input"==o.type||"numbers"==o.type||"subtotal"==o.type||"hidden"==o.type||"extension"==o.type)p=this.normalize_value(a.val(),c,null,0==a.data("converted"));else if("dropdown"==o.type)p=parseFloat(c.find(":selected").data("value"));else if("radio"==o.type)p=parseFloat(c.find(":checked").data("value"));else if("checkbox"==o.type)p=0,c.find(":checked").each(function(e,t){p+=parseFloat(P(t).data("value"))});else if("daterange"==o.type){var v=[c.find(".ezfc-element-daterange-from").datepicker("getDate"),c.find(".ezfc-element-daterange-to").datepicker("getDate")];p=H.jqueryui_date_diff(v[0],v[1],1==H.get_element_object_value(o,"workdays_only",0),o,n),_=H.jqueryui_date_diff(v[0],v[1],1==H.get_element_object_value(o,"workdays_only",0),o)}_||0==_||(_=p),"calculated"==n&&void 0!==t&&(p=t);var g=p,b=[];P.each(r,function(e,t){var a;if(!(u[e].length<1)&&(d[e]||0===d[e]||(d[e]=Number.NEGATIVE_INFINITY),f[e]||0===f[e]||(f[e]=Number.POSITIVE_INFINITY),g>=parseFloat(d[e])&&g<=parseFloat(f[e]))){var i,r=parseFloat(u[e]);switch(b.push(e),"calculated"==m&&(p=_),t){case"add":a=s+(i=r),l?s=a:s+=a;break;case"subtract":a=s-(i=r),l?s=a:s-=a;break;case"percent_add":s=a=s+(i=p*h*(r/100));break;case"percent_sub":s=a=s-(i=p*h*(r/100));break;case"equals":s=a=i=r;break;case"factor":a=i=p*r,H.set_element_object_value(o,"factor",r),s=a}if("subtotal"==o.type&&!isNaN(a)){var n=P(c).find("input");n.val(a),n.data("converted",0)}H.add_debug_info("discount",c,"discount = "+i+"\nprice after discount = "+s)}}),H.set_element_object_value(o,"__discount_table_active_ids",b)}return s},this.discount_table_update=function(e){var t,a=H.get_element_object_value(e,"__discount_table_active_ids",[]),i=H.get_element_object_value(e,"__discount_table_dom_cached",!1),r="ezfc-element-discount-table-highlighted";i?t=i:(t=H.get_element_dom(e.id).find(".ezfc-element-discount-table tbody"),H.set_element_object_value(e,"__discount_table_dom_cached",t));if(t.find(".ezfc-element-discount-table-highlighted").removeClass(r),a){var n=t.find("tr");for(var s in a)n.eq(a[s]).addClass(r)}},this.calculate_set_elements=function(e,t,a,i,r){var n,s=this.get_element_object(a.data("id")),o=this.get_element_object_value(s,"set_operator"),c=this.get_element_object_value(s,"set_elements"),l=1==this.get_element_object_value(s,"set_allow_zero"),_=this.get_element_object_value(s,"set_dom_selector"),d=this.get_element_object_value(s,"set_use_factor",1),f=[];if(c||_){if(_)f=P(_);else{var u=c;P.each(u,function(e,t){var a=P("#ezfc_element-"+t);a&&f.push(a)})}P.each(f,function(e,t){var a=P(t),i=(H.get_element_object(a.data("id")),H.get_value_from_element(a,null,!1,0==d));if(l||0!=i)if(0!=e)switch(o){case"min":i<n&&(n=i);break;case"max":n<i&&(n=i);break;case"avg":case"sum":n+=i;break;case"dif":n-=i;break;case"prod":n*=i;break;case"quot":0!=i&&(n/=i)}else n=i}),"avg"==o&&(n/=f.length);var m=this.normalize_value(n,a);s.current_value=n,s.current_value_formatted=m,a.find("input").val(m)}},this.calculate_price=function(e){var t=P(e).data("id"),a=0;this.subtotals[t]=[];var i=0<this.trigger_list[t].length?this.trigger_list[t]:H.form_vars[t].form_elements_order,r=!0;for(var n in H.form_vars[t].hasOwnProperty("global_conditions")&&H.calculate_conditionals(e,t,H.form_vars[t].global_conditions,!1,!0),i){var s=i[n],o=H.get_element_object(s),c=H.get_element_dom(s);H.calculate_get_external_values(e,t,c,o.type),void 0===o.calculate&&"custom_calculation"!=o.type&&"matrix"!=o.type&&"set"!=o.type||(r=!1,H.calculate_conditionals(e,t,s,o.type),!H.element_is_visible(s)&&0==o.calculate_when_hidden&&"hidden"!=o.type&&"custom_calculation"!=o.type||H.calculate_set_elements(e,t,c,o.type))}if(r)return this.price_old_global[t];for(var l in H.form_vars[t].form_elements_order){s=H.form_vars[t].form_elements_order[l],o=H.get_element_object(s),c=H.get_element_dom(s);if(void 0!==o.calculate||"custom_calculation"===o.type||"matrix"==o.type||"set"==o.type){var _=H.calculate_element_loop(s,o.type,a),d=H.calculate_element_loop(s,o.type,0,!0);if(H.calculate_conditionals(e,t,s,o.type),H.set_element_object_value(s,"current_value",d),1==H.get_element_object_value(o,"calculate_enabled",1)&&0<H.get_element_object_value(o,"add_to_price",1)&&this.element_can_calculate_visibility(s)&&(a=_),0==H.get_element_object_value(o,"add_to_price",1)){var f=H.get_value_from_element(c,null,!0);H.set_element_object_value(o,"current_value",f)}1==H.get_element_object_value(o,"calculate_enabled",1)&&H.subtotals[t].push({el_id:s,price:a})}}return a},this.set_price=function(e,t,a){var r=P(e).data("id");a?price=a:t&&0===t||(price=this.calculate_price(P(e))),this.set_subtotal_values(P(e)),1!=this.form_vars[r].price_show_request||0!=this.form_vars[r].price_requested?(void 0!==this.price_old_global[r]&&!isNaN(this.price_old_global[r])||(this.price_old_global[r]=0),$form_price_elements=P(document).find(".ezfc-price-value[data-id='"+r+"']"),this.price_old_global[r]!=price?(0!=this.form_vars[r].counter_duration?$form_price_elements.countTo({from:H.price_old_global[r],to:price,speed:this.form_vars[r].counter_duration,refreshInterval:this.form_vars[r].counter_interval,formatter:function(e,t){var a=H.format_price(r,e),i=numeral(a).value();return!isNaN(i)&&i||(a=0),a}}):$form_price_elements.text(this.format_price(r,price)),this.price_old_global[r]=price):$form_price_elements.text(this.format_price(r,price))):this.price_request_toggle(r,!1)},this.conditional_check_multiple_options=function(e,t){var a=!1;for(var i in"string"==typeof e&&(e=e.split("|")),"string"==typeof t&&(t=t.split("|")),e)for(var r in t)t[r]==e[i]&&(a=!0);return a},this.format_value_element=function(e,t){var a=this.get_element_object(e);return this.format_price(a.form_id,t,null,a.price_format,a.is_currency,!0)},this.format_price=function(e,t,a,i,r,n,s){var o=this.defaultFormat,c=a||this.form_vars[e].currency;this.form_vars[e].price_format&&this.form_vars[e].price_format.length&&(o=this.form_vars[e].price_format),null!=i&&(o=i),!isNaN(t)&&null!==t||(t=0);var l=n?numeral().set(t):numeral(t),_=this.is_empty(o)?this.defaultFormat:o,d=l.format(_);return"NaN"===d&&(d=t),1==ezfc_vars.price_format_replace_trailing_zeros.enabled&&parseFloat(t).toFixed(6)%1==0&&(d+=ezfc_vars.price_format_dec_point+ezfc_vars.price_format_replace_trailing_zeros.text),1==r&&1==H.form_vars[e].format_currency_numbers_elements&&(0==this.form_vars[e].currency_position?d=c+d:d+=c),d},this.price_request_toggle=function(e,t,a){var i=P(".ezfc-form[data-id='"+e+"']");t?(this.price_old_global[e]=0,this.form_vars[e].price_requested=1,this.calculate_price(i),this.set_price(i,null,a),this.set_submit_text(i)):(this.form_vars[e].price_requested=0,P(i).find(".ezfc-price-value").text(this.form_vars[e].price_show_request_before),P(i).find(".ezfc-submit").val(this.form_vars[e].submit_text.request))},this.set_subtotal_values=function(e){var f=["subtotal","set","numbers","custom_calculation"],u=P(e).data("id"),m=["subtotal","set"];P.each(H.form_vars[u].form_elements_order,function(e,t){var a=H.get_element_object(t),i=H.get_element_dom(t);if(-1!==P.inArray(a.type,f)){var r=H.get_element_object_value(a,"precision",2),n=a.price_format;$element_input="custom_calculation"==a.type?i.find(".ezfc-element-custom-calculation-input"):i.find(".ezfc-element-"+a.type);var s=a.current_value;H.object_has_property(a,"current_value_forced")&&(s=a.current_value_forced);var o=H.normalize_value(s,$element_input,r,0==$element_input.data("converted"));if(""!=$element_input.data("min")){var c=parseFloat($element_input.data("min"));o<c&&(o=c)}if(""!=$element_input.data("max")){var l=parseFloat($element_input.data("max"));l<o&&(o=l)}var _="",d="";if(0!=H.form_vars[u].format_number_show_zero||""!=o&&0!=o)_=H.format_price(a.form_id,o,null,n,!1,0==$element_input.data("converted")),d=H.format_price(a.form_id,o,null,n,a.is_currency,0==$element_input.data("converted")),d=H.get_element_object_value(a,"text_before","")+d+H.get_element_object_value(a,"text_after","");else o="";-1!==P.inArray(a.type,m)&&($element_input.val(d),$element_input.data("converted",1)),i.find(".ezfc-text").text(_)}})},this.scroll=function(){P(".ezfc-fixed").each(function(){var e=P(this).data("id");if(H.form_vars[e]){var t="ezfc-fixed-scrolling",a=P(this).offset(),i=P(".ezfc-form[data-id='"+e+"']"),r=i.outerHeight(),n=i.offset(),s=P(window).scrollTop(),o=parseFloat(H.form_vars[e].price_position_scroll_top),c=n.top-s-o;c<0&&-r<c?(P(this).offset({top:s+o}),P(this).addClass(t)):0<c&&a.top>n.top&&(P(this).offset({top:n.top}),P(this).removeClass(t))}})},this.reset_disabled_fields=function(e,t){var a=P(e).closest(".ezfc-wrapper");P(e).find(".ezfc-custom-hidden").each(function(){P.each(P(this).find("input, :selected"),function(e,t){P(this).val(P(this).data("index")).removeAttr("disabled"),P(this).is(":checked")&&P(this).prop("checked",!1)})}),a.find(".ezfc-payment-submit, .ezfc-payment-cancel").prop("disabled",!1),this.set_submit_text(e,t)},this.reset_form=function(e){this.init_form(e),this.reset_elements(e),this.set_step(e,0,0),this.form_change(e)},this.reset_elements=function(e){e.find(".ezfc-custom-element").each(function(){var e=P(this).data("id"),t=H.get_element_object(e);if("group"!=t.type&&1!=H.get_element_object_value(t,"keep_value_after_reset",0)){var a=P(this).data("element"),i=P(this).find("[data-initvalue]").data("initvalue");switch(a){case"checkbox":P(this).find("input").each(function(){1==(i=P(this).data("initvalue"))?P(this).prop("checked",!0):P(this).removeAttr("checked")});break;case"dropdown":P(this).find("option").removeAttr("selected"),P(this).find("option[data-index='"+i+"']").prop("selected",!0);break;case"numbers":P(this).find("input").val(i);var r=P(this).find(".ezfc-slider-element");r.length&&r.slider({value:i});break;case"radio":P(this).find("input").removeAttr("checked"),P(this).find("input[data-initvalue]").prop("checked",!0);break;case"textfield":P(this).find("textarea").val(i);break;default:P(this).find("input").val(i)}}}),e.find(".ezfc-selected").removeClass("ezfc-selected")},this.set_step=function(t,a,e){var i=parseInt(t.find(".ezfc-step-active").data("step")),r=t.find(".ezfc-step[data-step='"+i+"']"),n=t.data("id");if(this.step_is_changing=!1,i!=a){if(1==e&&1==this.form_vars[n].verify_steps)return t.find(".ezfc-step-submit-icon").fadeIn(),this.form_submit(t,a-1),void P(".ezfc-has-hidden-placeholder").val("").removeClass("ezfc-has-hidden-placeholder");var s=parseInt(this.form_vars[n].step_indicator_start)-1,o=parseInt(this.form_vars[n].step_speed);if(isNaN(o)&&(o=200),r.fadeOut(o,function(){var e=t.find(".ezfc-step[data-step='"+a+"']");e.fadeIn(o).addClass("ezfc-step-active"),P(this).removeClass("ezfc-step-active"),s<=a?t.find(".ezfc-step-indicator").fadeIn():t.find(".ezfc-step-indicator").hide(),H.scroll_to(e)}),t.find(".ezfc-step-indicator-item").each(function(){var e=parseInt(P(this).data("step"));P(this).removeClass("ezfc-step-indicator-item-active"),e<=a&&P(this).addClass("ezfc-step-indicator-item-active")}),a<i&&1==H.form_vars[n].step_reset_succeeding)for(var c=a+1;c<H.form_vars[n].step_count;c++){var l=P(".ezfc-step[data-step='"+c+"']");this.reset_elements(l)}return H.current_steps[n]=a,H.calculate_price(t),!1}},this.set_step_action=function(e,t,a){if(!this.step_is_changing){var i=P("#ezfc-form-"+e),r=parseInt(i.find(".ezfc-step-active").data("step")),n=0;switch(t){case"step_prev":if(0==r)return;n=r-1;break;case"step_next":if(r==i.find(".ezfc-step-start").length-1)return;n=r+1;break;case"step_goto":if(a=parseInt(a),isNaN(a))return;var s=i.find(".ezfc-step-start[data-id='"+a+"']");if(s.length<1)return;n=parseInt(s.data("step"))}this.step_is_changing=!0,setTimeout(function(){H.set_step(i,n,1)},350)}},this.scroll_to=function(e,t){var a=P(e).offset();if(void 0!==a&&0!=ezfc_vars.auto_scroll_steps){var i=parseFloat(t)||parseFloat(ezfc_vars.scroll_steps_offset)||50,r=a.top+i;P("html, body").animate({scrollTop:r})}},this.get_element_dom=function(e){return void 0!==this.$form_elements[e]&&this.$form_elements[e].$element},this.get_element_child_input_dom=function(e){return void 0!==this.$form_elements[e]&&this.$form_elements[e].$element_input},this.get_object_value=function(e,t,a,i){return"object"!=typeof e?a:e&&this.object_has_property(e,t)?"object"==typeof e[t]&&void 0!==i&&void 0!==e[t][i]?e[t][i]:e[t]:a},this.get_element_object=function(e){if(void 0===this.$form_elements[e])return!1;var t=this.$form_elements[e].form_id;return void 0!==ezfc_vars.element_vars[t][e]&&ezfc_vars.element_vars[t][e]},this.get_element_object_value=function(e,t,a){return"object"!=typeof e&&(e=this.get_element_object(e)),e&&this.object_has_property(e,t)?e[t]:a},this.set_element_object_value=function(e,t,a){if("object"!=typeof e){if("price"==e||"submit_button"==e)return;e=this.get_element_object(e)}if(!e)return!1;e[t]=a},this.set_element_list_object_value=function(e,t,a){for(var i in e)H.set_element_object_value(e[i],t,a)},this.get_top_parent_group_id=function(e){var t=this.get_element_object(e);return!!t&&(0!=t.group_id?this.get_top_parent_group(t.group_id):t.id)},this.has_parent_group_id=function(e,t){var a=this.get_element_object(e);return!(!a.group_id||0==a.group_id)&&(e!=t&&(a.group_id==t||this.has_parent_group_id(a.group_id,t)))},this.get_group_children=function(e){var t=this.get_element_object(e);if(!t)return[];var a=[];for(var i in H.form_vars[t.form_id].form_elements_order){var r=H.form_vars[t.form_id].form_elements_order[i];H.get_element_object(r);r!=e&&H.has_parent_group_id(r,e)&&a.push(r)}return a},this.get_value_from_element=function(e,t,a,i,r){if(r=P.extend({},{return_array:!1,return_value:"value"},r),!e&&t&&void 0!==this.$form_elements[t]&&(e=this.$form_elements[t].$element),!e||!e.length)return this.debug_message("Unable to find element #"+t,2),0;t=t||e.data("id");var n=this.get_element_object(t);if(!n)return 0;var s=this.get_element_child_input_dom(t),o=n.type,c=this.get_element_object_value(t,"factor",1),l=s.val(),_=0==s.data("converted"),d=this.normalize_value(l,e,null,_);if(0==n.calculate_when_hidden&&!this.element_is_visible(t)&&"hidden"!=o&&"custom_calculation"!=o)return 0;d&&!isNaN(d)||(d=0);var f=a?d:parseFloat(d);switch("count"==r.return_value&&(f=0),o){case"subtotal":case"numbers":case"hidden":c&&!isNaN(c)||0===c||(c=1),f=a?l:i?d:d*c;break;case"dropdown":case"radio":case"checkbox":var u=r.return_value,m=!a&&-1===P.inArray(u,["count","name","option_id"]);e.find(":selected, :checked").each(function(){if(m)f+=parseFloat(P(this).data("value"));else if("object"!=typeof f&&"count"!=u&&(f=[]),"name"==u){var e=P(this).data("index");f.push(n.options[e].text)}else"option_id"==u?f.push(P(this).data("optionid")):"count"==u?f++:f.push(P(this).data(u))});break;case"datepicker":f=e.find(".ezfc-element-datepicker").datepicker("getDate"),a=!0;break;case"daterange":var p=[e.find(".ezfc-element-daterange-from").datepicker("getDate"),e.find(".ezfc-element-daterange-to").datepicker("getDate")];if(a)f=p;else{e.find(".ezfc-element-daterange-container");var h=H.jqueryui_date_diff(p[0],p[1],1==this.get_element_object_value(n,"workdays_only",0),n);f=i?h:h*c}break;case"custom_calculation":f=e.find(".ezfc-element-custom-calculation-input").val(),a||(f=parseFloat(f));break;case"starrating":f=parseFloat(e.find(":checked").val()),isNaN(f)&&(f=0);break;case"table_order":var v=0;P.each(n.table_order,function(e,t){var a=parseFloat(P("#"+t.input_id).val()),i=parseFloat(t.value)*a;"count"==r.return_value?v+=a:v+=i}),f=v;break;case"set":f=n.current_value;break;case"input":case"textfield":f="letter_count"==r.return_value?String(l).replace(/\s+/g,"").length:"letter_count_with_space"==r.return_value?String(l).replace(/\r?\n|\r/g,"").length:l;break;case"discount_codes":f=H.get_element_object_value(n,"discount_value",0);break;case"address_distance":f=H.get_element_object_value(n,"distance_value",0);break;case"fileupload":case"group":case"heading":case"hr":case"html":case"image":case"placeholder":case"spacer":case"stepstart":case"stepend":f=0;break;default:f=l}if(!1,!a)return isNaN(f)&&(f=0),f?parseFloat(f):0;if("name"==u){var g=(new DOMParser).parseFromString(f,"text/html");g.body&&g.body.textContent&&(f=g.body.textContent)}return f},this.checkbox_change=function(e){var t=parseInt(e.attr("data-max_selectable"));t||e.find("input:not(:checked):not(.force-disabled)").removeAttr("disabled"),t&&0<=t&&(t<=e.find(":checked").length?e.find("input:not(:checked)").attr("disabled","disabled"):e.find("input:not(:checked):not(.force-disabled)").removeAttr("disabled"))},this.checkbox_change_state=function(e,t,a,i){if(e.attr("disabled"))return!1;null==t&&(t=!e.is(":checked"));var r=e.closest(".ezfc-element-single-option-container");if(r.hasClass("ezfc-element-option-has-image")){var n=e.siblings(".ezfc-element-option-image");t?n.addClass("ezfc-selected"):n.removeClass("ezfc-selected")}t?r.addClass("ezfc-option-wrapper-selected"):r.removeClass("ezfc-option-wrapper-selected"),i||e.prop("checked",t),a||e.trigger("change")},this.radio_change_state=function(e,t,a){var i=e.closest(".ezfc-form").data("id");if(e.attr("disabled"))return!1;void 0===t&&(t=!e.is(":checked"));var r=e.closest(".ezfc-element-radio-container"),n=r.closest(".ezfc-element-wrapper-radio");if(r.find(".ezfc-selected").removeClass("ezfc-selected"),r.find(".ezfc-element-radio-input").removeAttr("checked"),t&&(r.siblings(".ezfc-option-wrapper-selected").removeClass("ezfc-option-wrapper-selected"),r.addClass("ezfc-option-wrapper-selected")),r.hasClass("ezfc-element-option-has-image")){var s=e.siblings(".ezfc-element-option-image");t&&(e.attr("checked","checked"),e.prop("checked",!0),n.find(".ezfc-selected").removeClass("ezfc-selected"),s.addClass("ezfc-selected"))}else t&&(e.attr("checked","checked"),e.prop("checked",!0));a||e.trigger("change"),this.form_vars[i]&&1==this.form_vars[i].step_auto_progress&&!n.hasClass("disable-auto-progress")&&t&&this.set_step_action(i,"step_next")},this.live_summary_update=function(r){if(0!=this.form_vars[r].live_summary_enabled){var n="";P.each(ezfc_vars.element_vars[r],function(e,t){if(void 0!==t.current_value&&0!=t.show_in_live_summary){var a=P.trim(t.current_value);if(void 0!==t.options){if(0==(a=H.get_value_from_element(null,t.id,!0,null,{return_value:"name"})))return}else void 0!==t.current_value_formatted&&(a=t.current_value_formatted);if(""!=a&&0!=a){"object"==typeof a&&(a="<ul class='ezfc-live-summary-list'><li class='ezfc-live-summary-list-item'>"+a.join("</li><li class='ezfc-live-summary-list-item'>")+"</li></ul>");var i={current_value:a,element:t,form_id:r};a=H.call_hook("ezfc_live_summary_item",i).current_value,n+="<div class='ezfc-live-summary-item'><div class='ezfc-live-summary-item-name'>"+t.label+"<span class='ezfc-live-summary-item-separator'></span></div><div class='ezfc-live-summary-item-value'>"+a+"</div></div>"}}}),P("#ezfc-live-summary-"+r).find(".ezfc-live-summary-content").html(n)}},this.input_format_listener_change=function(c){var e=c.parent().closest(".ezfc-element").data("id"),l=this.get_element_object(e);if(l){var _=l.form_id,d=this.get_element_object_value(l,"text_before",""),f=this.get_element_object_value(l,"text_after",""),u=this.get_element_object_value(l,"price_format",null);c.on("focus click",function(){var e=H.escape_regex(d),t=H.escape_regex(f);""!=d&&(this.value=this.value.replace(new RegExp("^"+e,""),"")),""!=f&&(this.value=this.value.replace(new RegExp(t+"$",""),"")),1==l.is_number&&(this.value=this.value.replace(/[^0-9\.,-]/g,""),this.value=this.value.replace(ezfc_vars.price_format_dec_thousand,""))});function t(e,t){var a=e.value;if(e.value=H.get_element_object_value(l,"current_value_forced",e.value),1==H.get_element_object_value(l,"is_number",1)){e.value=e.value.replace(/[^0-9\.,-]/g,"");var i=c.data("min"),r=c.data("max");if(""!=e.value){var n=H.normalize_value(e.value);isNaN(n)||(""!=i&&!isNaN(i)&&n<i&&(e.value=i),""!=r&&!isNaN(r)&&r<n&&(e.value=r))}}var s=e.value!=a;if(0!=H.form_vars[_].format_number_show_zero||""!=e.value&&0!=e.value){if(1==H.get_element_object_value(l,"is_currency",1)){var o=H.normalize_value(e.value);e.value=H.format_price(_,o,null,u,H.form_vars[_].format_currency_numbers_elements,null,l)}}else e.value="";""!=e.value&&(e.value=d+e.value+f),H.set_element_object_value(l,"current_value_formatted",e.value),s&&!t&&H.form_change(null,_),H.live_summary_update(_),1==H.get_element_object_value(l,"discount_show_table",0)&&1==H.get_element_object_value(l,"discount_show_table_indicator",1)&&H.discount_table_update(l)}c.on("blur",function(){t(this)}),c.bind("ezfc_blur_trigger",function(){t(this,!0)})}},this.element_is_visible=function(e){var t=this.get_element_object(e);if(!t)return!1;var a=this.$form_elements[e].$element,i=this.$form_elements[e].form_id;this.form_vars[i].has_steps;return!a.hasClass("ezfc-custom-hidden")&&!a.hasClass("ezfc-hidden")&&(0==t.group_id||a.closest(".ezfc-custom-hidden, .ezfc-hidden").length<1)},this.element_can_calculate_visibility=function(e){var t=this.get_element_object(e);return!!t&&(0!=this.get_element_object_value(t,"calculate_when_hidden",0)||this.element_is_visible(e))},this.clear_hidden_values=function(e){var t=P(e).data("id");1==this.form_vars[t].clear_selected_values_hidden&&P(e).find(".ezfc-custom-hidden").each(function(){P(this).find("input[type='text']").val(""),P(this).find(":checkbox, :radio").prop("checked",!1)})},this.clear_hidden_values_element=function(e){var t=this.get_element_object(e),a=this.get_element_dom(e),i=this.get_element_child_input_dom(e);"input"==t.type||"numbers"==t.type||"subtotal"==t.type?i.val(""):"dropdown"==t.type?a.find(":selected").removeAttr("selected"):"radio"==t.type?this.radio_change_state(a.find(".ezfc-element-radio-input"),!1):"checkbox"==t.type&&this.checkbox_change_state(a.find(".ezfc-element-checkbox-input"),!1)},this.escape_regex=function(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},this.normalize_value=function(e,t,a,i){if(e=String(e),void 0!==t){var r=P(t).data("id"),n=this.get_element_object(r),s=P.trim(this.get_element_object_value(n,"text_before","")),o=P.trim(this.get_element_object_value(n,"text_after",""));if(""!=s){var c=H.escape_regex(s);e=e.replace(new RegExp("^"+c,""),"")}if(""!=o){var l=H.escape_regex(o);e=e.replace(new RegExp(l+"$",""),"")}}var _=parseFloat(e);return void 0===a||!a&&0!=a||(a=parseInt(a),_=_.toFixed(a)),i||(_=numeral(e).value()),_},this.set_submit_text=function(e,t){var a=P(e).data("id"),i=P(e).find(".ezfc-submit"),r="default",n=this.form_vars[a].submit_text.default;if(1==this.form_vars[a].price_show_request){if(this.form_vars[a].price_requested&&!t||(n=this.form_vars[a].submit_text.request,r="request"),t)return this.price_request_toggle(a,!1),!1}else if(1==this.form_vars[a].summary_enabled&&0==this.form_vars[a].summary_shown)r="summary",n=this.form_vars[a].submit_text.summary;else if(1==this.form_vars[a].use_paypal)r="paypal",n=this.form_vars[a].submit_text.paypal;else if(1==this.form_vars[a].payment_force_stripe)r="stripe",n=this.form_vars[a].submit_text.stripe;else if(1==this.form_vars[a].use_woocommerce)r="woocommerce",n=this.form_vars[a].submit_text.woocommerce;else{n=this.form_vars[a].submit_text.default;var s=P(e).find(".ezfc-element-wrapper-payment");if(0<s.length){var o=P(s).find(":checked").data("value");void 0!==this.form_vars[a].submit_text[o]&&(r=o,n=this.form_vars[a].submit_text[o])}}i.val(n),i.data("type",r)},this.prevent_enter_step_listener=function(e,t){P(e).keypress(function(e){e.keyCode||e.which;13==e.which&&e.preventDefault()})},this.call_hook=function(e,t){var a=window[e];return t=void 0===t?{}:t,"function"!=typeof a?t:a(t)},this.stripe_response_handler=function(e,t){var a=P(".ezfc-form[data-id='"+H.payment_form_id+"']"),i=P(".ezfc-payment-form[data-form_id='"+H.payment_form_id+"']");if(t.error)H.debug_message(t.error.message),P("#ezfc-payment-message-"+H.payment_form_id).text(t.error.message),i.find(".ezfc-payment-submit, .ezfc-payment-cancel").prop("disabled",!1),setTimeout(function(){P("#ezfc-payment-message-"+H.payment_form_id).text("")},7500);else{var r=t.id;a.find("#ezfc-stripetoken-"+H.payment_form_id).val(r),H.form_submit(a,-1,"stripe-checkout")}},this.authorize_create_token=function(e){var t={};authData={},cardData={};P("#ezfc-authorize-form-"+e);cardData.cardNumber=P("#ezfc-element-payment-authorize-card-number-"+e).val(),cardData.cardNumber=cardData.cardNumber.replace(/ /g,""),cardData.month=P("#ezfc-element-payment-authorize-expiry-month-"+e).val(),cardData.year=P("#ezfc-element-payment-authorize-expiry-year-"+e).val(),cardData.cardCode=P("#ezfc-element-payment-authorize-cvc-"+e).val(),t.cardData=cardData,authData.clientKey=ezfc_vars.authorize.client_key,authData.apiLoginID=ezfc_vars.authorize.api_login_id,t.authData=authData,Accept.dispatchData(t,H.authorize_response_handler)},this.authorize_response_handler=function(e){var t=P(".ezfc-form[data-id='"+H.payment_form_id+"']"),a=P(".ezfc-payment-form[data-form_id='"+H.payment_form_id+"']"),i=t.data("id");if("Error"===e.messages.resultCode){a.find(".ezfc-payment-submit, .ezfc-payment-cancel").prop("disabled",!1);for(var r=[],n=0;n<e.messages.message.length;n++)r.push(e.messages.message[n].text),H.debug_message(e.messages.message[n].code+": "+e.messages.message[n].text);H.set_message(i,r.join(" "))}else{var s=e.opaqueData.dataValue;P("#ezfc-authorizetoken-"+H.payment_form_id).val(s),H.form_submit(t,-1,"authorize-checkout")}},this.check_datepicker_days=function(e,t,a){if(!e||"object"!=typeof e||"function"!=typeof e.setHours)return[!1,""];e.setHours(0,0,0,0);var i=e.getTime();if(a.length)for(var r in a){if(a[r]=P.trim(a[r]),-1!==a[r].indexOf(":")){var n=a[r].split(":");if(2==n.length){var s=new Date(n[0]),o=new Date(n[1]);if(s.setHours(0,0,0,0),o.setHours(0,0,0,0),i>=s.getTime()&&i<=o.getTime())return[!1,""]}}else{var c=new Date(a[r]);if(c.setHours(0,0,0,0),i==c.getTime())return[!1,""]}}var l=e.getDay();return[-1!==P.inArray(l,t),""]},this.check_datepicker_predefined_values=function(e){var t=e.val(),a=!1;if(""!=t){switch(t){case"__today__":a=new Date;break;case"__tomorrow__":a=new Date((new Date).getTime()+864e5);break;case"__current_month__":a=(new Date).getMonth();break;case"__current_year__":a=(new Date).getFullYear();break;default:a=t}a&&e.datepicker("setDate",a)}},this.check_inline_math=function(e,t){return e},this.get_target_subtotal_value=function(e,t,a){for(var i in this.subtotals[e])if(this.subtotals[e][i].el_id==t)return a?void 0!==this.subtotals[e][i-1]?this.subtotals[e][i-1].price:0:this.subtotals[e][i].price;return null},this.get_calculated_element_value=function(e,t){P("#ezfc-form-"+e);var a=this.get_element_object(t),i=this.$form_elements[t].$element.data("element");return 0==this.get_element_object_value(a,"calculate_enabled",1)?0:this.calculate_element_loop(t,i,0,!0)},this.set_message=function(e,t){var a=P("#ezfc-form-"+e);if(!a)return!1;var i,r=a.closest(".ezfc-wrapper");if(!(i=0<r.find(".ezfc-payment-dialog-open").length?r.find(".ezfc-payment-errors"):P("#ezfc-message-"+e)).length&&console)return console.log(t),!1;i.text(t).fadeIn().delay(7500).fadeOut()},this.recaptcha_reload=function(){P(".ezfc-form .g-recaptcha").length&&"undefined"!=typeof grecaptcha&&grecaptcha.reset()},this.populate_html_placeholders=function(c){c.find(".ezfc-html-placeholder").each(function(e,t){var a=P(t),i=a.closest(".ezfc-custom-element").data("id"),r=H.get_element_object(i),n="",s=H.functions.get_element_id_by_name(c.data("id"),a.data("listen_target"));if(s){var o=a.data("listen_retrieve");n=H.get_value_from_element(!1,s,!0,!1,{return_value:o}),0==H.get_element_object_value(r,"replace_placeholders_show_zero",1)&&0==n&&(n=""),"object"==typeof n&&(n=n.join(", ")),n=P.trim(n),a.text(n)}})},this.group_repeat=function(a){void 0===this.group_repeat_elements[a]&&(this.group_repeat_elements[a]=0),this.group_repeat_elements[a]++;var e=P("#ezfc_element-"+a),t=e.clone(!0),i=e.closest(".ezfc-form");t.find(".ezfc-group-repeatable-wrapper").remove(),t.insertAfter(e).attr("id",t.attr("id")+this.group_repeat_elements[a]),t.find("[id^='ezfc_element-']").each(function(){var e=P(this).attr("id")+"-"+H.group_repeat_elements[a],t=P(this).data("id")+"-"+H.group_repeat_elements[a];P(this).attr("id",e),P(this).data("id",t)}),this.form_change(i)},this.toggle_group=function(e,t){var a=e.find("> .ezfc-group-elements").first();if(e.hasClass("ezfc-group-collapsible")){a.slideToggle(500);var i="ezfc-group-active",r="fa-chevron-circle-down",n="fa-chevron-circle-right",s=e.find(".ezfc-collapse-icon i").first();s.hasClass(r)&&!t?(s.removeClass(r).addClass(n),e.removeClass(i)):(s.removeClass(n).addClass(r),e.addClass(i))}},this.init_tips=function(){P(".ezfc-element-description[data-ezfctip]").each(function(){var e=P(this).data("ezfctip");new Opentip(P(this),{background:ezfc_vars.opentip.background||"yellow",borderWidth:0,closeButtonCrossColor:ezfc_vars.opentip.color||"black",removeElementsOnHide:!0,target:P(this),tipJoint:ezfc_vars.required_text_position||"middle right"}).setContent(e)})},this.init_table_order=function(e){for(var t in ezfc_vars.element_vars[e]){var a=ezfc_vars.element_vars[e][t];if("table_order"==a.type)for(var i in a.table_order){var r=a.table_order[i].option.value,n=P("#"+H.get_element_object_value(a.table_order[i],"price_column_id",!1)),s=H.format_price(e,r,null,null,a.is_currency);n.text(s)}}},this.show_tip=function(e,t,a,i){var r=new Opentip(e,{background:ezfc_vars.opentip.background||"yellow",closeButtonCrossColor:ezfc_vars.opentip.color||"black",delay:a,hideDelay:.1,hideTriggers:["closeButton","target"],removeElementsOnHide:!0,showOn:null,target:t,tipJoint:ezfc_vars.required_text_position||"middle right"});r.setContent(i),r.show()},this.submit_cancel=function(e,t){var a=e.closest(".ezfc-wrapper"),i=e.find("input[type='submit']"),r=e.find(".ezfc-submit-icon"),n=e.data("id");for(var s in r.fadeOut(),i.prop("disabled",!1),a.find(".ezfc-payment-submit, .ezfc-payment-cancel").prop("disabled",!1),this.payment_methods){var o=H.payment_methods[s];H.form_vars[n].payment_info_shown[o]=0}},this.popup_form_open=function(e){P(".ezfc-modal").addClass("ezfc-modal-open"),P("#ezfc-form-popup-"+e).fadeIn()},this.popup_form_close=function(e){P(".ezfc-modal").removeClass("ezfc-modal-open"),P("#ezfc-form-popup-"+e).fadeOut()},this.remove_debug_info=function(){P(".ezfc-debug-info").remove()},this.add_debug_info=function(e,t,a){if(2==ezfc_vars.debug_mode&&"group"!=(e=e||P(t).data("element"))){var i=P(t).attr("id"),r="ezfc-debug-"+(i=i&&i.split("ezfc_element-")[1]),n=P("#"+r).length;if("custom_calculation"!=e||!n){var s="[["+e+" #"+i+"]]\n["+e+"]\n"+a+"\n\n";n?P(t).find(".ezfc-debug-info").append(s):P(t).append("<pre id='"+r+"' class='ezfc-debug-info ezfc-debug-type-"+e+"'>"+s+"</pre>"),console.log(a,t)}}},this.debug_message=function(e,t){t=void 0===t?1:t,0==ezfc_vars.debug_mode||ezfc_vars.debug_mode<t||console.log(e)},this.jqueryui_date_diff=function(e,t,a,i,r){if(!e||!t)return 0;var n=new Date(e),s=new Date(t),o=0,c=0,l=!1,_=[],d=!1,f=!1;if(r=r||"calculated",1==this.get_element_object_value(i,"daterange_count_full_days",0)&&(s=s.setDate(s.getDate()+1)),i&&(d=this.get_element_object_value(i,"datepicker_day_prices_default",!1),f=this.get_element_object_value(i,"datepicker_day_prices",!1),"object"==typeof d&&(d=P.map(d,parseFloat)),"object"==typeof f))for(var u in f){var m=f[u].split("=");if(1<m.length){l=!0;var p=m[0].split(":");p[0]=new Date(p[0]),p[1]=new Date(p[1]);var h=P.map(m[1].split(","),parseFloat);_.push({start:p[0],end:p[1],prices:h})}}for(;n<s;){var v=n.getUTCDay(),g=this.dates_get_single_price(_,n),b=!1;a?6!==v&&7!==v&&(b=!0):b=!0,b&&o++,-1!=g?c+=g:d&&void 0!==d[v]&&(c+=d[v]),n.setDate(n.getDate()+1)}return l&&"raw"!=r?c:o},this.dates_get_single_price=function(e,t){for(var a in e){var i=e[a];if(t>=i.start&&t<=i.end){var r=t.getUTCDay();if(void 0!==i.prices[r])return i.prices[r];if("undefined"!==i.prices[0])return i.prices[0]}}return-1},this.roundTo=function(e,t){t=Math.max(0,parseInt(t));var a=Math.pow(10,t),i=e*a;return Math.round(i)/a},this.sprintf=function(){var a=arguments,i=1;return a[0].replace(/%((%)|s|d)/g,function(e){var t=null;if(e[2])t=e[2];else{switch(t=a[i],e){case"%d":t=parseFloat(t),isNaN(t)&&(t=0)}i++}return t})},this.throttle=function(i,r,n){var s,o;return r=r||100,function(){var e=n||this,t=+new Date,a=arguments;s&&t<s+r?(clearTimeout(o),o=setTimeout(function(){s=t,i.apply(e,a)},r)):(s=t,i.apply(e,a))}},this.unique=function(e){var a=[];return P.each(e,function(e,t){-1===P.inArray(t,a)&&a.push(t)}),a},this.has_class=function(e,t){for(var a in t)if(e.hasClass(t[a]))return!0;return!1},this.is_empty=function(e){return""===P.trim(e)},this.object_has_property=function(e,t){return"object"==typeof e&&null!==e&&e.hasOwnProperty(t)},this.generate_ref_id=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()},this.set_ref_id=function(e){var t=this.generate_ref_id();P("#ezfc-ref-id-"+e).val(t)},this.get_calculation_routine_by_name=function(e,t){if(!e.hasOwnProperty("calculate_routine"))return!1;t=P.trim(t);var a=[];for(var i in e.calculate_routine)e.calculate_routine[i].name==t&&a.push(parseInt(i));return a},this.file_upload_attach_event=function(e,t,a,i){return""==P(e).val()||(t.files=t.originalFiles,t.submit(),P(a).attr("disabled","disabled"),i.preventDefault()),!1},this.init()},ezfc_functions={},jQuery(document).ready(function(e){EZFC=new EZFC_Object(e)});